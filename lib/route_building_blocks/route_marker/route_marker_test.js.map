{"version":3,"file":"route_marker_test.js","sourceRoot":"","sources":["../../../src/route_building_blocks/route_marker/route_marker_test.ts"],"names":[],"mappings":"AAAA;;;;GAIG;AAEH,mCAAmC;AAEnC,OAAO,EAAC,IAAI,EAAiB,MAAM,KAAK,CAAC;AAEzC,OAAO,EAAC,iBAAiB,EAAC,MAAM,kCAAkC,CAAC;AACnE,OAAO,EAAC,WAAW,EAAC,MAAM,8BAA8B,CAAC;AAEzD,OAAO,EAAC,UAAU,EAAC,MAAM,+BAA+B,CAAC;AACzD,OAAO,EAAC,WAAW,EAAE,aAAa,EAAC,MAAM,6BAA6B,CAAC;AAEvE,OAAO,EAAC,WAAW,EAAC,MAAM,mBAAmB,CAAC;AAI9C,SAAS,gBAAgB,CACrB,CAAC,QAAQ,EAAE,QAAQ,CAAmB,EACtC,CAAC,MAAM,EAAE,MAAM,CAAmB;IACpC,OAAO,aAAa,CAAC;QACnB,IAAI,EAAE,CAAC,WAAW,CAAC;gBACjB,cAAc,EAAE,IAAI,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC;gBAClD,YAAY,EAAE,IAAI,UAAU,CAAC,MAAM,EAAE,MAAM,CAAC;aAC7C,CAAC,CAAC;KACJ,CAAC,CAAC;AACL,CAAC;AAED,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;IAC3B,MAAM,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC;IAE9B,SAAS,CAAC,GAAG,EAAE;QACb,GAAG,CAAC,oBAAoB,EAAE,CAAC;QAC3B,GAAG,CAAC,+BAA+B,EAAE,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,KAAK,UAAU,YAAY,CAAC,QAAyB;QACnD,MAAM,cAAc,GAAG,KAAK,CACD,GAAG,CAAC,qBAAsB,CAAC,SAAS,CAAC,QAAQ,CAAC,EAC9C,uBAAuB,CAAC;aACvB,GAAG,CAAC,WAAW,EAAE,CAAC;QAC9C,MAAM,IAAI,GACN,GAAG,CAAC,MAAM,CAAC,QAAQ,IAAI,IAAI,CAAA,yCAAyC,CAAC,CAAC;QAC1E,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAC7B,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAc,mBAAmB,CAAE,CAAC;QACrE,MAAM,WAAW,GAAG,MAAM,MAAM,CAAC,kBAAkB,CAAC;QAEpD,OAAO,EAAC,IAAI,EAAE,MAAM,EAAE,WAAW,EAAE,cAAc,EAAC,CAAC;IACrD,CAAC;IAED,EAAE,CAAC,YAAY,EAAE,GAAG,EAAE;QACpB,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;QACvD,MAAM,CAAC,EAAE,CAAC,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;QACnD,MAAM,EAAC,MAAM,EAAE,cAAc,EAAC,GAAG,MAAM,YAAY,EAAE,CAAC;QAEtD,MAAM,CAAC,cAAc,CAAC,CAAC,wBAAwB,EAAE,CAAC;QAClD,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,WAAW,EAAE,CAAC;QACzC,MAAM,WAAW,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,YAAY,EAAE,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,kDAAkD,EAAE,KAAK,IAAI,EAAE;QAChE,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,EAAE,CAAC;QAE3C,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,CAAC;QAC3C,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;QACrD,mBAAmB;QACnB,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;;iBAEhC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;QAC1D,mBAAmB;QACnB,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;;iBAEhC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6BAA6B,EAAE,KAAK,IAAI,EAAE;QAC3C,mBAAmB;QACnB,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;;iBAEhC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;QAChD,mBAAmB;QACnB,MAAM,EAAC,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;;iBAExC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAC,KAAK,GAAG,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAChD,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;QACnD,mBAAmB;QACnB,MAAM,EAAC,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;;iBAExC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAC,QAAQ,GAAG,aAAa,CAAC;QAChC,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC1D,MAAM,CAAE,WAAW,CAAC,QAAmB,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;QACvD,KAAK,CAAC,iBAAiB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;QAE5C,mBAAmB;QACnB,MAAM,YAAY,CAAC,IAAI,CAAA;qCACU,SAAqB;iBACzC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;2BACtB,CAAC,CAAC;QACzB,kBAAkB;QAElB,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,KAAK,CAAC;aACpC,wBAAwB,CACrB,kCAAkC;YAClC,6CAA6C,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0BAA0B,EAAE,KAAK,IAAI,EAAE;QACxC,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;+DACc,CAAC,CAAC;QAE7D,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,+BAA+B,EAAE,KAAK,IAAI,EAAE;QAC7C,MAAM,EAAC,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;+DACM,CAAC,CAAC;QAE7D,MAAM,CAAC,KAAK,GAAG,WAAW,CAAC;QAC3B,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;QACzC,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;mCACd,CAAC,uBAAuB,CAAC,CAAC;QAEzD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;QAC/C,MAAM,EAAC,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;mCACtB,CAAC,uBAAuB,CAAC,CAAC;QAEzD,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;QAClB,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;QACzD,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;sEACqB,CAAC,CAAC;QAEpE,MAAM,CAAE,WAAW,CAAC,OAAmB,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;IACjE,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;QACxD,MAAM,EAAC,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;sEACa,CAAC,CAAC;QAEpE,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAClD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QAC/B,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC/C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,mBAAmB,EAAE,KAAK,IAAI,EAAE;QACjC,MAAM,EAAC,IAAI,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;iEACU,CAAC,CAAC;QAC/D,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAiB,SAAS,CAAE,CAAC;QAE3D,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC7C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,wBAAwB,EAAE,KAAK,IAAI,EAAE;QACtC,MAAM,EAAC,IAAI,EAAE,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;iEACE,CAAC,CAAC;QAC/D,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAiB,SAAS,CAAE,CAAC;QAE3D,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QACxB,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAC;IACrC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;QACzE,MAAM,EAAC,IAAI,EAAE,MAAM,EAAE,WAAW,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,CAAA;iEACE,CAAC,CAAC;QAC/D,MAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAiB,SAAS,CAAE,CAAC;QAE3D,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QACxB,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QACxB,MAAM,GAAG,CAAC,gBAAgB,EAAE,CAAC;QAE7B,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,CAAC;IACtC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/**\r\n * @license\r\n * Copyright 2023 Google LLC\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n// import 'jasmine'; (google3-only)\r\n\r\nimport {html, TemplateResult} from 'lit';\r\n\r\nimport {LoggingController} from '../../base/logging_controller.js';\r\nimport {Environment} from '../../testing/environment.js';\r\nimport {FakeMapElement} from '../../testing/fake_gmp_components.js';\r\nimport {FakeLatLng} from '../../testing/fake_lat_lng.js';\r\nimport {makeFakeLeg, makeFakeRoute} from '../../testing/fake_route.js';\r\n\r\nimport {RouteMarker} from './route_marker.js';\r\n\r\ntype LatLng = google.maps.LatLng;\r\n\r\nfunction fakeRouteBetween(\r\n    [startLat, startLng]: [number, number],\r\n    [endLat, endLng]: [number, number]): google.maps.DirectionsRoute {\r\n  return makeFakeRoute({\r\n    legs: [makeFakeLeg({\r\n      start_location: new FakeLatLng(startLat, startLng),\r\n      end_location: new FakeLatLng(endLat, endLng),\r\n    })]\r\n  });\r\n}\r\n\r\ndescribe('RouteMarker', () => {\r\n  const env = new Environment();\r\n\r\n  beforeAll(() => {\r\n    env.defineFakeMapElement();\r\n    env.defineFakeAdvancedMarkerElement();\r\n  });\r\n\r\n  async function prepareState(template?: TemplateResult) {\r\n    const constructorSpy = spyOn(\r\n                               env.fakeGoogleMapsHarness!.libraries['marker'],\r\n                               'AdvancedMarkerElement')\r\n                               .and.callThrough();\r\n    const root =\r\n        env.render(template ?? html`<gmpx-route-marker></gmpx-route-marker>`);\r\n    await env.waitForStability();\r\n    const marker = root.querySelector<RouteMarker>('gmpx-route-marker')!;\r\n    const innerMarker = await marker.innerMarkerPromise;\r\n\r\n    return {root, marker, innerMarker, constructorSpy};\r\n  }\r\n\r\n  it('is defined', () => {\r\n    const el = document.createElement('gmpx-route-marker');\r\n    expect(el).toBeInstanceOf(RouteMarker);\r\n  });\r\n\r\n  it('constructs an AdvancedMarkerElement', async () => {\r\n    const {marker, constructorSpy} = await prepareState();\r\n\r\n    expect(constructorSpy).toHaveBeenCalledOnceWith();\r\n    expect(marker.innerMarker).toBeDefined();\r\n    await expectAsync(marker.innerMarkerPromise).toBeResolved();\r\n  });\r\n\r\n  it('sets default values on the AdvancedMarkerElement', async () => {\r\n    const {innerMarker} = await prepareState();\r\n\r\n    expect(innerMarker.position).toBeNull();\r\n    expect(innerMarker.zIndex).toBeUndefined();\r\n    expect(innerMarker.title).toEqual('');\r\n  });\r\n\r\n  it('sets position to origin via attribute', async () => {\r\n    // clang-format off\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker waypoint=\"origin\"\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    expect((innerMarker.position as LatLng).lat()).toEqual(1);\r\n    expect((innerMarker.position as LatLng).lng()).toEqual(2);\r\n  });\r\n\r\n  it('sets position to destination via attribute', async () => {\r\n    // clang-format off\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker waypoint=\"destination\"\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    expect((innerMarker.position as LatLng).lat()).toEqual(3);\r\n    expect((innerMarker.position as LatLng).lng()).toEqual(4);\r\n  });\r\n\r\n  it('defaults position to origin', async () => {\r\n    // clang-format off\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    expect((innerMarker.position as LatLng).lat()).toEqual(1);\r\n    expect((innerMarker.position as LatLng).lng()).toEqual(2);\r\n  });\r\n\r\n  it('updates position on route change', async () => {\r\n    // clang-format off\r\n    const {marker, innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker waypoint=\"origin\"\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    marker.route = fakeRouteBetween([5, 6], [7, 8]);\r\n    await env.waitForStability();\r\n\r\n    expect((innerMarker.position as LatLng).lat()).toEqual(5);\r\n    expect((innerMarker.position as LatLng).lng()).toEqual(6);\r\n  });\r\n\r\n  it('updates position on waypoint change', async () => {\r\n    // clang-format off\r\n    const {marker, innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker waypoint=\"origin\"\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    marker.waypoint = 'destination';\r\n    await env.waitForStability();\r\n\r\n    expect((innerMarker.position as LatLng).lat()).toEqual(3);\r\n    expect((innerMarker.position as LatLng).lng()).toEqual(4);\r\n  });\r\n\r\n  it('logs an error on invalid waypoint value', async () => {\r\n    spyOn(LoggingController.prototype, 'error');\r\n\r\n    // clang-format off\r\n    await prepareState(html`\r\n      <gmpx-route-marker .waypoint=${'invalid' as 'origin'}\r\n        .route=${fakeRouteBetween([1, 2], [3, 4])}>\r\n      </gmpx-route-marker>`);\r\n    // clang-format on\r\n\r\n    expect(LoggingController.prototype.error)\r\n        .toHaveBeenCalledOnceWith(\r\n            'Unsupported waypoint \"invalid\". ' +\r\n            'Waypoint must be \"origin\" or \"destination\".');\r\n  });\r\n\r\n  it('sets title via attribute', async () => {\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker title=\"my title\"></gmpx-route-marker>`);\r\n\r\n    expect(innerMarker.title).toEqual('my title');\r\n  });\r\n\r\n  it('updates title on title change', async () => {\r\n    const {marker, innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker title=\"my title\"></gmpx-route-marker>`);\r\n\r\n    marker.title = 'new title';\r\n    await env.waitForStability();\r\n\r\n    expect(innerMarker.title).toEqual('new title');\r\n  });\r\n\r\n  it('sets zIndex from property', async () => {\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker .zIndex=${5}></gmpx-route-marker>`);\r\n\r\n    expect(innerMarker.zIndex).toEqual(5);\r\n  });\r\n\r\n  it('updates zIndex on zIndex change', async () => {\r\n    const {marker, innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker .zIndex=${5}></gmpx-route-marker>`);\r\n\r\n    marker.zIndex = 6;\r\n    await env.waitForStability();\r\n\r\n    expect(innerMarker.zIndex).toEqual(6);\r\n  });\r\n\r\n  it('sets custom content from the default slot', async () => {\r\n    const {innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker><div id=\"slotted\"></div></gmpx-route-marker>`);\r\n\r\n    expect((innerMarker.content as Element).id).toEqual('slotted');\r\n  });\r\n\r\n  it('updates custom content added dynamically', async () => {\r\n    const {marker, innerMarker} = await prepareState(html`\r\n      <gmpx-route-marker><div id=\"slotted\"></div></gmpx-route-marker>`);\r\n\r\n    const newContent = document.createElement('span');\r\n    marker.appendChild(newContent);\r\n    await env.waitForStability();\r\n\r\n    expect(innerMarker.content).toBe(newContent);\r\n  });\r\n\r\n  it('connects to a map', async () => {\r\n    const {root, innerMarker} = await prepareState(html`\r\n      <gmp-map><gmpx-route-marker></gmpx-route-marker></gmp-map>`);\r\n    const map = root.querySelector<FakeMapElement>('gmp-map')!;\r\n\r\n    expect(innerMarker.map).toBe(map.innerMap);\r\n  });\r\n\r\n  it('disconnects from a map', async () => {\r\n    const {root, marker, innerMarker} = await prepareState(html`\r\n      <gmp-map><gmpx-route-marker></gmpx-route-marker></gmp-map>`);\r\n    const map = root.querySelector<FakeMapElement>('gmp-map')!;\r\n\r\n    map.removeChild(marker);\r\n    await env.waitForStability();\r\n\r\n    expect(innerMarker.map).toBeNull();\r\n  });\r\n\r\n  it('is disconnected after a synchronous connect -> disconnect', async () => {\r\n    const {root, marker, innerMarker} = await prepareState(html`\r\n      <gmp-map></gmp-map><gmpx-route-marker></gmpx-route-marker>`);\r\n    const map = root.querySelector<FakeMapElement>('gmp-map')!;\r\n\r\n    map.appendChild(marker);\r\n    map.removeChild(marker);\r\n    await env.waitForStability();\r\n\r\n    expect(innerMarker.map).toBeFalsy();\r\n  });\r\n});\r\n"]}