{"version":3,"file":"poll_test.js","sourceRoot":"","sources":["../../src/utils/poll_test.ts"],"names":[],"mappings":"AAAA;;;;GAIG;AAEH,mCAAmC;AAEnC,OAAO,EAAC,IAAI,EAAC,MAAM,WAAW,CAAC;AAE/B,MAAM,qBAAqB,GAAG,IAAI,CAAC;AAEnC,QAAQ,CAAC,MAAM,EAAE,GAAG,EAAE;IACpB,UAAU,CAAC,GAAG,EAAE;QACd,OAAO,CAAC,KAAK,EAAE,CAAC,OAAO,EAAE,CAAC;IAC5B,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACb,OAAO,CAAC,KAAK,EAAE,CAAC,SAAS,EAAE,CAAC;IAC9B,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0DAA0D,EAAE,GAAG,EAAE;QAClE,MAAM,EAAE,GAAG,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QACzC,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QAExB,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,qBAAqB,CAAC,CAAC;QACtC,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC;QAEhD,MAAM,CAAC,EAAE,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;IACtC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4DAA4D,EAAE,GAAG,EAAE;QACpE,MAAM,EAAE,GAAG,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QACzC,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QAExB,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,qBAAqB,CAAC,CAAC;QACtC,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC;QAChD,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QAE5C,MAAM,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;IACpC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6DAA6D,EAAE,GAAG,EAAE;QACrE,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC3C,MAAM,GAAG,GAAG,OAAO,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;QAC3C,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QAExB,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,qBAAqB,CAAC,CAAC;QACvC,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,qBAAqB,CAAC,CAAC;QACvC,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QAE5C,MAAM,CAAC,GAAG,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QACrC,MAAM,CAAC,GAAG,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;IACvC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/**\r\n * @license\r\n * Copyright 2024 Google LLC\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\n// import 'jasmine'; (google3-only)\r\n\r\nimport {Poll} from './poll.js';\r\n\r\nconst TEST_POLLING_INTERVAL = 1000;\r\n\r\ndescribe('Poll', () => {\r\n  beforeEach(() => {\r\n    jasmine.clock().install();\r\n  });\r\n\r\n  afterEach(() => {\r\n    jasmine.clock().uninstall();\r\n  });\r\n\r\n  it('polls callback function continuously after set intervals', () => {\r\n    const cb = jasmine.createSpy('callback');\r\n    const poll = new Poll();\r\n\r\n    poll.start(cb, TEST_POLLING_INTERVAL);\r\n    jasmine.clock().tick(TEST_POLLING_INTERVAL * 2);\r\n\r\n    expect(cb).toHaveBeenCalledTimes(2);\r\n  });\r\n\r\n  it('does not poll callback function if stopped before interval', () => {\r\n    const cb = jasmine.createSpy('callback');\r\n    const poll = new Poll();\r\n\r\n    poll.start(cb, TEST_POLLING_INTERVAL);\r\n    jasmine.clock().tick(TEST_POLLING_INTERVAL / 2);\r\n    poll.stop();\r\n    jasmine.clock().tick(TEST_POLLING_INTERVAL);\r\n\r\n    expect(cb).not.toHaveBeenCalled();\r\n  });\r\n\r\n  it('stops polling first callback when starting another callback', () => {\r\n    const cb1 = jasmine.createSpy('callback1');\r\n    const cb2 = jasmine.createSpy('callback2');\r\n    const poll = new Poll();\r\n\r\n    poll.start(cb1, TEST_POLLING_INTERVAL);\r\n    jasmine.clock().tick(TEST_POLLING_INTERVAL);\r\n    poll.start(cb2, TEST_POLLING_INTERVAL);\r\n    jasmine.clock().tick(TEST_POLLING_INTERVAL);\r\n\r\n    expect(cb1).toHaveBeenCalledTimes(1);\r\n    expect(cb2).toHaveBeenCalledTimes(1);\r\n  });\r\n});\r\n"]}