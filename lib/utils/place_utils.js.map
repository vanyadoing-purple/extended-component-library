{"version":3,"file":"place_utils.js","sourceRoot":"","sources":["../../src/utils/place_utils.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * @license\r\n * Copyright 2023 Google LLC\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport {html} from 'lit';\r\n\r\nimport {APILoader} from '../api_loader/api_loader.js';\r\n\r\nimport {extractTextAndURL} from './dom_utils.js';\r\nimport type {LatLng, LatLngLiteral, Place, PlaceResult, PriceLevel} from './googlemaps_types.js';\r\nimport {isOpen} from './opening_hours.js';\r\n\r\n/**\r\n * Returns true if `place` is a `PlaceResult`, and false if it's a `Place`.\r\n *\r\n * @param place - A `google.maps.places.Place` or\r\n *     `google.maps.places.PlaceResult`.\r\n */\r\nexport function isPlaceResult(place: Place|PlaceResult): place is PlaceResult {\r\n  // To avoid depending on loading the API at runtime, we do not use\r\n  // `instanceof google.map.places.Place`.\r\n  // TODO: fix for property renaming safety?\r\n  return !place.hasOwnProperty('id');\r\n}\r\n\r\n/**\r\n * Contains info that describes the origin or destination of a journey. This\r\n * interface is compatible with `google.maps.Place` and is suitable for use in\r\n * a request to the Directions or Distance Matrix services.\r\n */\r\nexport interface WaypointInfo {\r\n  location?: LatLngLiteral;\r\n  placeId?: string;\r\n  query?: string;\r\n}\r\n\r\n/** Creates a new `WaypointInfo` object based on input data. */\r\nexport function makeWaypoint(data: LatLng|LatLngLiteral|Place): WaypointInfo {\r\n  if (isPlace(data)) {\r\n    return {\r\n      location: data.location?.toJSON() ?? undefined,\r\n      placeId: data.id,\r\n      query: data.formattedAddress ?? data.displayName ?? undefined,\r\n    };\r\n  }\r\n  if (isLatLng(data)) {\r\n    return {location: data.toJSON()};\r\n  }\r\n  return {location: data};\r\n}\r\n\r\nfunction isPlace(data: LatLng|LatLngLiteral|Place): data is Place {\r\n  return data.hasOwnProperty('id');\r\n}\r\n\r\nfunction isLatLng(data: LatLng|LatLngLiteral): data is LatLng {\r\n  return typeof data.lat === 'function';\r\n}\r\n\r\nconst PRICE_LEVEL_CONVERSIONS: Record<PriceLevel, number> = Object.freeze({\r\n  'FREE': 0,\r\n  'INEXPENSIVE': 1,\r\n  'MODERATE': 2,\r\n  'EXPENSIVE': 3,\r\n  'VERY_EXPENSIVE': 4,\r\n});\r\n\r\nconst REVERSE_PRICE_LEVEL_CONVERSIONS: Record<number, PriceLevel> =\r\n    Object.freeze(Object.fromEntries(\r\n        Object.entries(PRICE_LEVEL_CONVERSIONS).map(tup => tup.reverse())));\r\n\r\n/**\r\n * Converts an enum price level to the corresponding numeric value. If passed a\r\n * numeric value, it will return it unchanged.\r\n */\r\nexport function priceLevelToNumeric(level: number|PriceLevel): number|null {\r\n  if (typeof level === 'number') return level;\r\n  return PRICE_LEVEL_CONVERSIONS[level] ?? null;\r\n}\r\n\r\n/**\r\n * Converts a numeric price level to the corresponding enum value. If passed an\r\n * enum value, it will return it unchanged.\r\n */\r\nexport function numericToPriceLevel(level: number|PriceLevel): PriceLevel|null {\r\n  if (typeof level !== 'number') return level;\r\n  return REVERSE_PRICE_LEVEL_CONVERSIONS[level] ?? null;\r\n}\r\n\r\n/**\r\n * Renders attribution data returned by the Places API as either an `<a>` or a\r\n * `<span>` depending on the presence of the URL field.\r\n *\r\n * @param text Name of the author or provider.\r\n * @param url URL that links to the author or provider page.\r\n */\r\nexport function renderAttribution(text: string, url: string|null) {\r\n  return url ? html`<a href=${url} target=\"_blank\">${text}</a>` :\r\n               html`<span>${text}</span>`;\r\n}\r\n\r\n/**\r\n * Creates a new `Place` object that sources its property values from\r\n * equivalent fields in the `PlaceResult` object, if they are defined.\r\n */\r\nexport async function makePlaceFromPlaceResult(\r\n    placeResult: PlaceResult, consumer?: HTMLElement): Promise<Place> {\r\n  const placesLibrary = await APILoader.importLibrary('places', consumer) as\r\n      typeof google.maps.places;\r\n  const place = new placesLibrary.Place(\r\n                    {id: placeResult.place_id ?? 'PLACE_ID_MISSING'}) as Place;\r\n  let predefinedFields = convertToPlaceFields(placeResult);\r\n\r\n  // Override Place object's getters to return data from PlaceResult if defined.\r\n  return new Proxy(place, {\r\n    get(target, name, receiver) {\r\n      // Intercept calls to the `fetchFields()` method and filter out any field\r\n      // names in the request that already have values derived from PlaceResult.\r\n      if (name === 'fetchFields') {\r\n        return async (request: google.maps.places.FetchFieldsRequest) => {\r\n          const requestFields = request.fields as [keyof Place];\r\n          const forwardedFields = requestFields.filter(\r\n              (field) => predefinedFields[field] === undefined);\r\n          try {\r\n            return await target.fetchFields(\r\n                {...request, fields: forwardedFields});\r\n          } catch (e: unknown) {\r\n            // Place.fetchFields() is only available in beta versions of the\r\n            // Maps JS SDK. If a stable version of the SDK is loaded, fall\r\n            // back to the Place Details API.\r\n            if (isNotAvailableError(e, 'fetchFields()')) {\r\n              const placeResultFields =\r\n                  mapPlaceFieldsToPlaceResultFields(forwardedFields);\r\n              if (!placeResultFields.length) return {place};\r\n              const response = await fetchFromPlaceDetails(\r\n                  placesLibrary, place.id, placeResultFields);\r\n              predefinedFields = {\r\n                ...convertToPlaceFields(response),\r\n                ...predefinedFields,\r\n              };\r\n              return {place};\r\n            }\r\n            throw e;\r\n          }\r\n        };\r\n      } else if (name === 'isOpen') {\r\n        return async (d?: Date) => {\r\n          try {\r\n            // Must redirect the original isOpen() method's `this` to point to\r\n            // the proxy object.\r\n            return await Reflect.get(target, name, receiver).apply(receiver, [\r\n              d\r\n            ]);\r\n          } catch (e: unknown) {\r\n            if (isNotAvailableError(e, 'isOpen()')) return isOpen(receiver, d);\r\n            throw e;\r\n          }\r\n        };\r\n      }\r\n      const value = predefinedFields[name as keyof Place];\r\n      return value === undefined ? Reflect.get(target, name, receiver) : value;\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Determines whether the current Place object has enough data to evaluate\r\n * `isOpen()` or `getNextOpeningTime()` without making additional fetches.\r\n */\r\nexport function hasDataForOpeningCalculations(place: Place): boolean {\r\n  return !!(\r\n      place.businessStatus && place.regularOpeningHours &&\r\n      (place.utcOffsetMinutes != null));\r\n}\r\n\r\n/** Converts `PlaceResult` data to `Place`-compatible field values. */\r\nfunction convertToPlaceFields(placeResult: PlaceResult): Partial<Place> {\r\n  const place: Partial<Place> = {};\r\n  if (placeResult.address_components !== undefined) {\r\n    place.addressComponents = placeResult.address_components.map(\r\n        (component: google.maps.GeocoderAddressComponent) => ({\r\n          longText: component.long_name,\r\n          shortText: component.short_name,\r\n          types: component.types,\r\n        }));\r\n  }\r\n  if (placeResult.adr_address !== undefined) {\r\n    place.adrFormatAddress = placeResult.adr_address;\r\n  }\r\n  if (placeResult.business_status !== undefined) {\r\n    place.businessStatus = placeResult.business_status;\r\n  }\r\n  if (placeResult.formatted_address !== undefined) {\r\n    place.formattedAddress = placeResult.formatted_address;\r\n  }\r\n  if (placeResult.formatted_phone_number !== undefined) {\r\n    place.nationalPhoneNumber = placeResult.formatted_phone_number;\r\n  }\r\n  if (placeResult.geometry !== undefined) {\r\n    const geometry = placeResult.geometry;\r\n    if (geometry.location) place.location = geometry.location;\r\n    if (geometry.viewport) place.viewport = geometry.viewport;\r\n  }\r\n  if (placeResult.html_attributions !== undefined) {\r\n    place.attributions = placeResult.html_attributions.map((html: string) => {\r\n      const {text, url} = extractTextAndURL(html);\r\n      return {provider: text ?? '', providerURI: url ?? null};\r\n    });\r\n  }\r\n  if (placeResult.icon_background_color !== undefined) {\r\n    place.iconBackgroundColor = placeResult.icon_background_color;\r\n  }\r\n  if (placeResult.icon_mask_base_uri !== undefined) {\r\n    place.svgIconMaskURI = placeResult.icon_mask_base_uri;\r\n  }\r\n  if (placeResult.international_phone_number !== undefined) {\r\n    place.internationalPhoneNumber = placeResult.international_phone_number;\r\n  }\r\n  if (placeResult.name !== undefined) {\r\n    place.displayName = placeResult.name;\r\n  }\r\n  if (placeResult.opening_hours !== undefined) {\r\n    const periods = placeResult.opening_hours.periods?.map(\r\n        (period: google.maps.places.PlaceOpeningHoursPeriod) => ({\r\n          open: makeOpeningHoursPoint(period.open),\r\n          // A place that is open 24/7 does not return a close period.\r\n          close: period.close ? makeOpeningHoursPoint(period.close) : null,\r\n        }));\r\n    place.regularOpeningHours = {\r\n      periods: periods ?? [],\r\n      weekdayDescriptions: placeResult.opening_hours.weekday_text ?? [],\r\n    };\r\n  }\r\n  if (placeResult.photos !== undefined) {\r\n    place.photos =\r\n        placeResult.photos.map((photo: google.maps.places.PlacePhoto) => {\r\n          const attributions = photo.html_attributions.map((html) => {\r\n            const {text, url} = extractTextAndURL(html);\r\n            return {displayName: text ?? '', photoURI: '', uri: url || ''};\r\n          });\r\n          return {\r\n            authorAttributions: attributions,\r\n            getURI: photo.getUrl,\r\n            heightPx: photo.height,\r\n            widthPx: photo.width,\r\n          };\r\n        });\r\n  }\r\n  if (placeResult.place_id !== undefined) {\r\n    place.id = placeResult.place_id;\r\n  }\r\n  if (placeResult.plus_code !== undefined) {\r\n    place.plusCode = {\r\n      compoundCode: placeResult.plus_code.compound_code ?? null,\r\n      globalCode: placeResult.plus_code.global_code,\r\n    };\r\n  }\r\n  if (placeResult.price_level !== undefined) {\r\n    place.priceLevel = numericToPriceLevel(placeResult.price_level);\r\n  }\r\n  if (placeResult.rating !== undefined) {\r\n    place.rating = placeResult.rating;\r\n  }\r\n  if (placeResult.reviews !== undefined) {\r\n    place.reviews = placeResult.reviews.map(\r\n        (review: google.maps.places.PlaceReview) => ({\r\n          authorAttribution: {\r\n            displayName: review.author_name,\r\n            photoURI: review.profile_photo_url,\r\n            uri: review.author_url || '',\r\n          },\r\n          // Convert publish time from milliseconds to a Date object.\r\n          publishTime: new Date(review.time),\r\n          rating: review.rating ?? null,\r\n          relativePublishTimeDescription: review.relative_time_description,\r\n          text: review.text,\r\n          textLanguageCode: review.language,\r\n        }));\r\n  }\r\n  if (placeResult.types !== undefined) {\r\n    place.types = placeResult.types;\r\n  }\r\n  if (placeResult.url !== undefined) {\r\n    place.googleMapsURI = placeResult.url;\r\n  }\r\n  if (placeResult.user_ratings_total !== undefined) {\r\n    place.userRatingCount = placeResult.user_ratings_total;\r\n  }\r\n  if (placeResult.utc_offset_minutes !== undefined) {\r\n    place.utcOffsetMinutes = placeResult.utc_offset_minutes;\r\n  }\r\n  if (placeResult.website !== undefined) {\r\n    place.websiteURI = placeResult.website;\r\n  }\r\n  return place;\r\n}\r\n\r\n/**\r\n * Creates a `OpeningHoursPoint` object, and extracts `hours` and `minutes`\r\n * from the `time` property.\r\n */\r\nfunction makeOpeningHoursPoint(\r\n    {day, hours, minutes}: google.maps.places.PlaceOpeningHoursTime):\r\n    google.maps.places.OpeningHoursPoint {\r\n  return {day, hour: hours, minute: minutes};\r\n}\r\n\r\nconst PLACE_TO_PLACE_RESULT_FIELDS:\r\n    Partial<Record<keyof Place, keyof PlaceResult>> = {\r\n      'addressComponents': 'address_components',\r\n      'adrFormatAddress': 'adr_address',\r\n      'businessStatus': 'business_status',\r\n      'formattedAddress': 'formatted_address',\r\n      'nationalPhoneNumber': 'formatted_phone_number',\r\n      'location': 'geometry',\r\n      'viewport': 'geometry',\r\n      'iconBackgroundColor': 'icon_background_color',\r\n      'svgIconMaskURI': 'icon_mask_base_uri',\r\n      'internationalPhoneNumber': 'international_phone_number',\r\n      'displayName': 'name',\r\n      'regularOpeningHours': 'opening_hours',\r\n      'photos': 'photos',\r\n      'plusCode': 'plus_code',\r\n      'priceLevel': 'price_level',\r\n      'rating': 'rating',\r\n      'reviews': 'reviews',\r\n      'types': 'types',\r\n      'googleMapsURI': 'url',\r\n      'userRatingCount': 'user_ratings_total',\r\n      'utcOffsetMinutes': 'utc_offset_minutes',\r\n      'websiteURI': 'website',\r\n      'id': 'place_id'\r\n    };\r\n\r\n/** Maps a list of Place field names to equivalent PlaceResult field names. */\r\nexport function mapPlaceFieldsToPlaceResultFields(fields: Array<keyof Place>):\r\n    Array<keyof PlaceResult> {\r\n  const placeResultFields: Array<keyof PlaceResult> = [];\r\n  for (const placeField of fields) {\r\n    const mapped = PLACE_TO_PLACE_RESULT_FIELDS[placeField];\r\n    if (mapped) placeResultFields.push(mapped);\r\n  }\r\n  return placeResultFields;\r\n}\r\n\r\n/**\r\n * Determines if the error results from a specified property not being\r\n * available on the Place class (or an instance of that class).\r\n */\r\nexport function isNotAvailableError(e: unknown, property: string): e is Error {\r\n  if (!(e instanceof Error)) return false;\r\n  return e.message.startsWith(`Place.prototype.${property} is not available`) ||\r\n      e.message.startsWith(\r\n          `google.maps.places.Place.${property} is not available`);\r\n}\r\n\r\nasync function fetchFromPlaceDetails(\r\n    placesLibrary: typeof google.maps.places, placeId: string,\r\n    fields: string[]): Promise<PlaceResult> {\r\n  const placesService =\r\n      new placesLibrary.PlacesService(document.createElement('div'));\r\n  return new Promise((resolve, reject) => {\r\n    placesService.getDetails({placeId, fields}, (result, status) => {\r\n      if (result && status === 'OK') {\r\n        resolve(result);\r\n      } else {\r\n        reject(status);\r\n      }\r\n    });\r\n  });\r\n}"]}